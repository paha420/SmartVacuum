# SmartVacuum

Скрипт **SmartVacuum** автоматически запускает уборку роботом Xiaomi, только когда дома никого нет.

## Как это работает
1. На роутере (например, OpenWrt) скрипт через `ssh` и `iwinfo` получает список устройств, подключенных к заданным Wi‑Fi интерфейсам.
2. Если среди подключенных устройств есть телефоны хозяев (указанные в списке `PHONE_MACS`), уборка не запускается.
3. Когда телефонов нет, скрипт проверяет, что робот пылесос находится на базе и готов к работе, и запускает уборку командой `mirobo start`.
4. Пока пылесос работает, каждые `CLEANING_CHECK_INTERVAL` секунд скрипт снова проверяет наличие телефонов. Если кто‑то подключился, уборка прерывается командой `mirobo home`.
5. После завершения уборки соблюдается пауза (`MIN_CLEAN_INTERVAL`), чтобы не запускать робот слишком часто.

## Настройка
* `PHONE_MACS` — список MAC‑адресов телефонов, которые определяют присутствие хозяев.
* `AP_INTERFACES` — названия Wi‑Fi интерфейсов на роутере, которые следует опрашивать.
* `ROUTER_IP` — адрес роутера для подключения по SSH.
* `VACUUM_IP` и `VACUUM_TOKEN` — параметры робота пылесоса для управления через `mirobo`.
* Остальные параметры (`CHECK_INTERVAL`, `CLEANING_CHECK_INTERVAL` и т. д.) позволяют настроить частоту проверок и поведения уборки.

## Требования
* Python 3.
* Установленный CLI‑клиент [mirobo](https://github.com/marcelbuesing/python-miio) и доступность его из командной строки.
* Возможность входа на роутер по SSH без запроса пароля.

## Запуск
```bash
python vacuum.py
```
